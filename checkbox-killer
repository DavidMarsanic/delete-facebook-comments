from PIL import ImageGrab, Image
import pyautogui

# Take a screenshot of the entire screen using Pillow
screenshot = ImageGrab.grab()

def locate_image_on_screen(image_path, screenshot):
    search_image = Image.open(image_path)
    search_data = list(search_image.getdata())
    screen_data = list(screenshot.getdata())

    for y in range(screenshot.height - search_image.height + 1):
        for x in range(screenshot.width - search_image.width + 1):
            if screen_data[y * screenshot.width + x] == search_data[0]:
                match_found = all(
                    screen_data[(y + i) * screenshot.width + x + j] == search_data[i * search_image.width + j]
                    for i in range(search_image.height)
                    for j in range(search_image.width)
                )
                if match_found:
                    return x + search_image.width // 2, y + search_image.height // 2
    return None

# Locate the "Remove" button within the screenshot
remove_button_location = locate_image_on_screen('remove_button.png', screenshot)
if remove_button_location:
    pyautogui.click(remove_button_location)
    print("Remove button clicked!")
else:
    print("Remove button not found!")
